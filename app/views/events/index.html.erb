<h1>All Events</h1>

  <div id="event-details-map"></div>

<script>
  var events = <%= raw @events.as_json %>
  var currentLocation = <%= raw @current_location.as_json %>

  // JS for producing google map with marker
  function initMap() {

    var map = new google.maps.Map(document.getElementById('event-details-map'), {
      zoom: 11,
      center: {lat: currentLocation[0], lng: currentLocation[1]}
    });

    setMarkers(map);
  };

  function setMarkers(map) {
    var image = {
      url: 'http://b.fastcompany.net/asset_files/-/2014/11/13/poop.png',
      size: new google.maps.Size(26, 26),
      origin: new google.maps.Point(0, 0),
      anchor: new google.maps.Point(0, 26)
    };

    var shape = {
      coords: [1, 1, 1, 20, 18, 20, 18, 1],
      type: 'poly'
    };

    for (var i = 0; i < events.length; i++) {
      var event = events[i]
      var marker = new google.maps.Marker({
        position: {lat: event[1], lng: event[2]},
        map: map,
        icon: image,
        shape: shape,
        title: event[0],
        zIndex: event[3]
      });
      marker.addListener('click', function() {
        infowindow.open(map, marker);
      });

      var contentString = "dog!"

      var infowindow = new google.maps.InfoWindow({
        content: contentString,
        maxWidth: 200
      });
    };
  }

</script>

 <script async defer
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDAvBDiolWNKT2Nn0wteaKxxKPQbk8ocjI&callback=initMap">
</script>

